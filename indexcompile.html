<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>WELLBORNE</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  
    <style>
          html {
            display: flex;
            justify-content: center;
          }

          body {
            max-width: 1080px;
            padding-top: calc(128px + 64px);
            font-size: 14px;
          }
          .content {
            display: block;
          }
          .text-green {
            color: #00b800;
          }
          .text-red {
            color: #c60606;
          }

          h2 {
            color: rgb(250, 250, 250);
            font-size: 1.5rem;
            font-weight: 400;
            margin-top: 5px;
            padding: 5px;
            background-color: rgb(35, 92, 167);
            margin-bottom: 0px;
          }
          .titre_IRV {
            background-color: rgb(175, 21, 49);
          }
          *, ::after, ::before {
            box-sizing: content-box;; 
          }


          input {
            width: 100%;
            padding: 5px;
            border: 1px solid black;
            border-radius: 5px;
            box-sizing: border-box;
          }
          select {
            width: 100%;
            padding: 5px;
            border: 1px solid black;
            border-radius: 5px;
            box-sizing: border-box;
          }



          table {
            width: 100%;
          }

          td, th {
            padding-left: 5px;
            padding-right: 5px;
          }

          table, th, td {
            border: 1px solid rgb(228, 228, 228);
          }
          td > input {
            width: 100%;
            padding: 2px;
            margin: 0px;
          }
          .gris {
            background-color: rgba(189, 189, 189, 0.74);
          }

          .cell-none {
            border: none;
          }

          td {
            background-color: #ededed;
          }

          .banner {
          width:100%;
          height: 128px;
          background-color: black;
          position: absolute;
          left:0;
          top:0;

          display: flex;
          justify-content: center;
          align-items: center;
          }

          .banner img {
            height: 80%;
          }

          h1 {
          color:rgb(0, 0, 0)

          }




          .titretableau {
            background-color: rgb(31, 128, 255);
            color: azure;
            padding: 1%;
            font-style: normal;
            font-size: larger;
          }
          .marine {

          background-color: rgb(123, 212, 247);

          }
          .clair {

          background-color:rgb(184, 217, 255);


          }
          td {
            min-width: 60px;
          }
          .info {
            background-color: orange;
            color: azure;
            padding: 1%;
            font-style: normal;
            font-size: larger;

          }
          label {
            display: block;
            font: 1rem 'Fira Sans', sans-serif;
          }

          input,
          label {
            margin: 0.4rem 0;
            text-align: right;
          }
          .textright
          {
            text-align: right;
          }
          .vert1 {
          background-color: rgb(156, 255, 136);

          }
          .vertclair {
          background-color: rgb(204, 247, 232);
          }
          .verneutre {
            background-color: rgb(10, 182, 10);
          }
          .vertfonce {
            background-color: rgb(1, 141, 1);
          }
          .bleu1 {
            background-color: rgb(25, 133, 240);
            color: white;
          }
          .bleu2 {
            background-color: rgb(5, 123, 197);
            color: white;
          }
          .bleu3 {
            background-color: rgb(7, 76, 186);
            color: white;
          }
          .bleu4 {
            background-color: rgb(4, 50, 124);
            color: white;
          }

          @media print {
            .no-print {
              display: none;
            }
            .no-page-break {
              page-break-inside: avoid;
            }
            table {
              page-break-inside: avoid;
            }
            body {
              margin-top: 0px;
              padding-top: calc(58px + 8px);
              font-size: 12px;
          }
            .container {
              max-width: 98%;
              margin-top: 0px;
            }
            .pack > div > input {
              max-width: 80%;
              font-size: 80%;
              border: none;
              background-color: #ffffff00;
            }
            .pack > div > select {
              max-width: 80%;
              font-size: 80%;
              border: none;
              background-color: none;
            }
            .banner {
              width:100%;
              height: 50px;
              background-color: rgb(205, 202, 202);
              position: absolute;
              left:0;
              top:0;
              display: flex;
              justify-content: center;
              align-items: center;
            }
            
            .banner svg {
              height: 70%;
            }
          }

          @media print {
            .no-print {
              display: none !important;
            }
            .no-page-break {
              page-break-inside: avoid;
            }
            .container {
              max-width: 98%;
              margin-top: 10px;
            }

            .pack > div > input {
              max-width: 80%;
              font-size: 80%;
              border: none;
              background-color: #ffffff00;
            }
            .pack > div > select {
              max-width: 80%;
              font-size: 80%;
              border: none;
              background-color: none;
            }
            .bg-black {
              background-color: #757474ea !important;
            }
          }
    </style>
  </head>
  <header>
    <div class="banner ">
      <svg
      version="1.1"
      id="svg2"
      width="120"
      height="120"
      viewBox="0 0 1024 1024"
      sodipodi:docname="WB logo.svg"
      inkscape:version="1.1.1 (3bf5ae0d25, 2021-09-20)"
      xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
      xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:svg="http://www.w3.org/2000/svg">
     <defs
        id="defs6" />
     <sodipodi:namedview
        id="namedview4"
        pagecolor="#ffffff"
        bordercolor="#111111"
        borderopacity="1"
        inkscape:pageshadow="0"
        inkscape:pageopacity="0"
        inkscape:pagecheckerboard="1"
        showgrid="false"
        inkscape:zoom="0.78320312"
        inkscape:cx="512"
        inkscape:cy="512.6384"
        inkscape:window-width="4300"
        inkscape:window-height="1711"
        inkscape:window-x="2391"
        inkscape:window-y="-9"
        inkscape:window-maximized="1"
        inkscape:current-layer="g8" />
     <g
        inkscape:groupmode="layer"
        inkscape:label="Image"
        id="g8">
       <g
          id="g980"
          transform="translate(-0.5536411,-0.7231916)">
         <path
            style="fill:#fcfdfe"
            d="M 0,512 V 0 h 512 512 v 512 512 H 512 0 Z"
            id="path986" />
         <path
            style="fill:#055df6"
            d="m 478.5,1022.8919 c -7.7,-0.449 -21.425,-1.7676 -30.5,-2.9302 C 368.77932,1009.8126 296.85429,983.40052 231.11603,940.31814 138.31612,879.50059 67.272808,789.36852 29.47672,684.5 14.743399,643.62113 4.3551491,593.9532 1.0317664,548.5 -0.27702475,530.59994 -0.27931614,485.07384 1.0277903,469.5 9.9065554,363.71178 50.268781,265.86975 119.42229,182.5 131.9764,167.36508 166.88878,132.43483 182,119.89027 222.28318,86.449236 266.52262,59.394704 313.42019,39.520546 357.32768,20.913522 407.97227,7.9743156 459,2.3263046 484.5311,-0.49960872 543.78627,-0.23402941 568.75088,2.8182037 671.28234,15.353948 761.14979,53.651262 838.88166,117.93533 c 15.85671,13.11346 47.12937,43.84527 60.46629,59.42054 62.6445,73.15818 102.33565,158.4328 117.60915,252.67794 20.7352,127.94684 -6.8327,256.5798 -78.05371,364.2018 -19.39837,29.31284 -38.66287,52.74281 -64.80242,78.81435 -38.26224,38.16266 -71.41113,63.17203 -116.60097,87.97027 -85.11827,46.70927 -179.62361,67.66697 -279,61.87167 z m 63,-85.92772 C 607.50543,932.11896 668.83649,913.31837 725.41516,880.5863 851.98561,807.36239 933.16439,672.12319 937.65916,527 939.0068,483.48852 933.6573,439.03004 921.95665,396.5 897.93263,309.17639 842.45856,227.65281 769.5,172.45276 707.89252,125.84087 640.60895,98.626821 561.5,88.323407 539.63787,85.47601 481.51797,85.715516 459.38645,88.744205 381.39183,99.417736 316.6748,125.49861 256.5,170.50716 164.88263,239.0336 104.76296,340.49592 89.113983,453 84.633525,485.21102 84.200117,513.91852 87.611792,552.5 100.42537,697.40438 190.34796,828.25492 322.01555,893.59177 371.62348,918.2085 425.29002,933.00964 479,936.88779 c 16.85345,1.21691 46.46976,1.25311 62.5,0.0764 z M 305.3484,803.5 C 302.60769,798.55125 185,545.03718 185,544.07808 185,543.32654 196.3212,543 222.37756,543 c 28.69314,0 37.61377,-0.29043 38.39423,-1.25 0.73208,-0.90009 -10.96836,-27.97608 -41.79787,-96.72443 -23.548,-52.51093 -42.59885,-95.82343 -42.33522,-96.25 C 176.90233,348.34901 206.54913,348 242.52047,348 h 65.40244 l 0.9894,3.75 c 0.54416,2.0625 6.89853,33.675 14.12081,70.25 7.22228,36.575 13.4936,66.87671 13.93628,67.33713 0.44267,0.46043 1.06062,0.42332 1.3732,-0.0824 0.31259,-0.50578 8.95246,-32.15508 19.19972,-70.3318 10.24726,-38.17671 19.1548,-69.74521 19.79453,-70.15223 0.63973,-0.40701 16.07055,-0.74692 34.29071,-0.75534 26.68178,-0.0123 33.34658,0.2486 34.25323,1.34105 0.61912,0.746 11.20464,40.97606 23.52336,89.40015 12.31873,48.42408 22.71198,89.03401 23.09611,90.2443 0.40578,1.27851 1.0697,1.82923 1.58455,1.31438 0.48737,-0.48737 10.37668,-41.36463 21.97623,-90.83835 11.59955,-49.47371 21.61858,-90.28836 22.26452,-90.69921 1.74735,-1.11141 166.65381,-0.90816 192.30135,0.23701 17.9859,0.80307 23.97466,1.45487 32,3.4828 27.64509,6.98565 44.73162,21.95613 49.85271,43.6788 1.91644,8.12916 1.90843,22.55212 -0.0171,30.72065 -3.53008,14.97571 -15.6448,30.63329 -29.84709,38.57566 -3.68917,2.0631 -6.55584,4.20635 -6.37036,4.76277 0.18547,0.55642 3.6937,1.98958 7.79605,3.1848 22.30039,6.49721 38.69438,21.32445 45.0585,40.7523 2.1376,6.5255 2.39625,9.07895 2.36295,23.32758 -0.0347,14.85451 -0.23627,16.57275 -2.81536,24 -7.01796,20.21029 -19.81286,34.23561 -41.30203,45.27384 -11.51362,5.91415 -20.19316,8.53034 -36.30469,10.943 -10.06966,1.5079 -20.39847,1.73167 -81.04053,1.75566 L 600.5,619.5 600.24582,503.75 C 600.07891,427.74433 599.64971,388 598.99582,388 598.44812,388 598,388.22902 598,388.50894 c 0,1.41894 -61.35943,228.24499 -62.14798,229.74106 -0.85365,1.61959 -3.74246,1.75 -38.76476,1.75 -29.10321,0 -38.06061,-0.28867 -38.7874,-1.25 -0.6788,-0.89785 -40.6998,-145.3844 -46.96075,-169.54089 -0.32657,-1.25999 -1.08186,-2.12819 -1.67842,-1.92934 -0.59657,0.19886 -11.46038,39.02976 -24.1418,86.29089 L 362.46176,619.5 322.23088,619.76134 282,620.02269 v 2.20389 c 0,1.21214 5.64482,42.01962 12.54405,90.68328 6.89922,48.66367 12.40183,89.40431 12.22802,90.53477 -0.31424,2.04373 -0.3223,2.04404 -1.42367,0.0554 z M 723.81687,568.96373 c 18.1201,-2.27207 30.30037,-9.88468 33.6015,-21.00079 2.02492,-6.81867 2.05721,-20.36356 0.062,-26.01854 -3.27009,-9.26842 -10.64039,-14.8172 -23.19999,-17.46625 -7.41194,-1.56332 -57.00836,-3.26521 -61.59645,-2.11367 L 670,503.0381 v 32.81429 c 0,18.04785 0.3,33.11428 0.66667,33.48094 1.06744,1.06745 44.07466,0.76838 53.1502,-0.3696 z M 716.91025,453.9448 c 17.13162,-2.77968 25.24646,-11.62334 25.32695,-27.60166 0.0747,-14.82032 -6.58004,-23.15636 -20.90981,-26.19278 -6.21041,-1.31596 -44.8729,-2.73223 -48.65734,-1.7824 L 670,399.0381 V 427.01905 455 l 20.25,-0.008 c 11.1375,-0.004 23.13461,-0.4756 26.66025,-1.04765 z M 429.5,720.03055 c -13.67954,-2.11051 -21.93165,-10.12368 -23.21324,-22.5411 -1.13733,-11.01961 3.57089,-20.97756 12.3513,-26.12323 3.93248,-2.30458 6.17785,-2.83709 13.42368,-3.18352 13.83482,-0.66145 20.4993,2.43251 24.61793,11.42878 1.86638,4.07671 2.35378,6.62448 2.12167,11.09053 L 458.5,696.5 l -17.29051,0.27379 c -18.97296,0.30043 -19.6489,0.54202 -16.82026,6.012 3.26985,6.3232 15.52191,8.05707 26.11077,3.69511 3.3,-1.3594 6.35897,-2.47372 6.79772,-2.47627 0.43874,-0.003 0.66374,2.80787 0.5,6.24537 l -0.29772,6.25 -5,1.63231 c -6.30381,2.05796 -16.50677,2.90003 -23,1.89824 z m 12.40958,-32.9535 c 1.18167,-0.74806 1.19992,-1.39848 0.11285,-4.02291 C 440.42792,679.20467 438.31135,678 433.14247,678 c -6.08896,0 -12.49722,6.31191 -9.4758,9.33333 0.99494,0.99494 16.61299,0.77553 18.24291,-0.25628 z m 169.23719,32.89804 c -13.60988,-2.83265 -21.3497,-14.19199 -19.79631,-29.05402 1.07277,-10.26372 6.94695,-18.35062 15.52899,-21.37854 5.18375,-1.82893 16.79597,-2.01967 22.31371,-0.36651 15.40432,4.61524 21.50983,25.8629 11.82151,41.13979 -4.93328,7.77899 -18.23445,12.08059 -29.8679,9.65928 z M 624.1504,707.91951 C 627.1083,706.33649 629,700.90002 629,693.98246 629,684.29858 625.09782,679 617.96606,679 611.35594,679 608,684.0838 608,694.09722 c 0,6.64198 1.86091,12.14532 4.6563,13.77025 2.40329,1.397 8.92584,1.42653 11.4941,0.052 z M 553,719.07185 c -1.375,-0.40084 -6.48325,-0.51595 -11.35168,-0.25582 -6.87456,0.36733 -9.0489,0.1615 -9.73468,-0.92153 -1.11613,-1.76265 -1.17184,-64.93917 -0.0588,-66.69385 0.57872,-0.91235 2.88243,-1.21019 7.73469,-1 L 546.5,650.5 547,661.17133 c 0.275,5.86924 0.74707,10.91631 1.04906,11.21572 0.30198,0.29942 2.74074,-0.56518 5.41947,-1.92133 8.42247,-4.26399 17.95425,-2.98923 23.74262,3.17529 3.98146,4.24018 5.79028,10.41707 5.77908,19.73472 -0.015,12.48627 -4.95704,21.20683 -14.20811,25.07122 -3.83817,1.6033 -11.39894,1.90267 -15.78212,0.6249 z m 8.62162,-12.55958 c 7.05866,-4.62501 7.27335,-21.44674 0.31962,-25.04265 -4.49485,-2.32439 -12.13853,-1.32924 -14.15558,1.84294 -0.97169,1.52817 -0.98944,21.83647 -0.0204,23.2875 1.88419,2.82122 9.49015,2.77303 13.85631,-0.0878 z m 217.21425,11.5702 c -7.10784,-2.77964 -10.4147,-5.59628 -13.24982,-11.28564 -2.85765,-5.73455 -3.49157,-14.9957 -1.51393,-22.11761 1.31004,-4.71771 6.94846,-11.10519 12.35967,-14.00164 3.44932,-1.84631 5.69048,-2.17758 14.73207,-2.17758 10.23554,0 10.83494,0.1205 14.92323,3 C 812.21538,675.81634 815,681.64534 815,690.15728 V 697 h -17.53138 c -19.36055,0 -20.71164,0.46914 -16.78449,5.82808 4.82406,6.58285 16.4083,8.20422 26.16517,3.66215 2.94211,-1.36963 5.77608,-2.49023 6.29771,-2.49023 0.52849,0 0.8166,2.76733 0.65071,6.25 l -0.29772,6.25 -5,1.70623 c -7.05853,2.40869 -23.36229,2.34067 -29.66413,-0.12376 z m 19.98089,-32.81117 c 0.19351,-1.36155 -0.66424,-3.20968 -2.20455,-4.75 -4.70612,-4.70612 -15.19427,-2.56419 -17.11765,3.49584 -1.11945,3.52707 0.29106,4.06755 9.83698,3.76931 8.61895,-0.26928 9.18744,-0.42003 9.48522,-2.51515 z M 330.0663,716.67439 c -3.20871,-8.43956 -14.08563,-45.83409 -13.57299,-46.66356 0.92424,-1.49545 14.04008,-1.27799 15.3114,0.25386 0.57728,0.69558 2.61548,7.47868 4.52933,15.07355 3.41805,13.56412 4.12727,15.53379 5.20512,14.45594 0.29653,-0.29654 2.47175,-6.81851 4.83382,-14.49328 2.36206,-7.67476 4.621,-14.48214 5.01986,-15.12751 1.00452,-1.62535 13.24915,-1.55959 14.26585,0.0766 0.42719,0.6875 2.65073,7.53233 4.94118,15.21072 2.29046,7.6784 4.57058,14.0961 5.06695,14.26155 0.49637,0.16546 2.4099,-5.89187 4.25229,-13.46072 1.84239,-7.56885 3.7654,-14.56824 4.27335,-15.55419 0.78163,-1.51717 2.02873,-1.74767 8.11554,-1.5 l 7.192,0.29264 -0.24946,3 c -0.13721,1.65 -3.29115,12.675 -7.00876,24.5 l -6.7593,21.5 -8.68653,0.28813 -8.68653,0.28814 -3.11649,-10.28814 C 359.74971,691.47926 358.87107,689 357.98015,689 c -0.47252,0 -2.04486,3.9375 -3.49409,8.75 -1.44923,4.8125 -3.44736,11.45 -4.44028,14.75 l -1.80532,6 -8.63012,0.28908 c -8.31404,0.27849 -8.6636,0.20103 -9.54404,-2.11469 z M 470.23687,684.75 470.5,650.5 h 7.5 7.5 l 0.26313,34.25 0.26313,34.25 H 478 469.97374 Z M 501,684.5 v -34.58413 l 7.75,0.29207 7.75,0.29206 v 34 34 l -7.75,0.29206 -7.75,0.29207 z m 156.46654,33.27341 c -0.27749,-0.72313 -0.38348,-11.88048 -0.23553,-24.7941 L 657.5,669.5 h 7.5 c 7.43844,0 7.5026,0.0226 7.81642,2.75 0.3889,3.37984 1.1151,3.41481 5.73975,0.27644 3.768,-2.55703 8.87015,-3.97386 12.09397,-3.35839 1.56288,0.29837 1.89544,1.47624 2.14367,7.59255 L 693.08762,684 h -7.47871 c -4.11329,0 -8.62178,0.4346 -10.01887,0.96577 l -2.54017,0.96577 -0.27493,16.28423 L 672.5,718.5 l -7.26446,0.2941 c -5.29731,0.21446 -7.40109,-0.0619 -7.769,-1.02069 z M 702.23244,694.29238 702.5,669.5 l 6.49696,-0.30413 c 5.63987,-0.264 6.72538,-0.0221 8.22841,1.83412 l 1.73144,2.13824 5.52665,-2.70394 c 4.64147,-2.27086 6.489,-2.63433 11.53504,-2.26933 6.78616,0.49086 10.33978,2.57577 13.4815,7.90957 1.81554,3.08231 2,5.19396 2,22.89547 v 19.5 l -7.66506,0.29054 -7.66506,0.29053 -0.33494,-16.93778 c -0.29603,-14.97024 -0.55623,-17.18204 -2.23993,-19.04053 -2.20919,-2.43855 -8.56283,-2.84731 -12.59501,-0.81031 -2.49185,1.25884 -2.50163,1.31995 -3,18.73526 l -0.5,17.47229 -7.76756,0.29238 -7.76756,0.29238 z"
            id="path984" />
         <path
            style="fill:#1f1f1d"
            d="m 423.37206,718.21609 c -2.82036,-1.00436 -6.30871,-2.59979 -7.75188,-3.54539 -6.83851,-4.48076 -10.72024,-16.05474 -8.68023,-25.88142 2.64785,-12.75464 11.19537,-19.78381 25.02174,-20.57698 9.56485,-0.5487 15.11719,0.96072 20.10298,5.46509 4.53701,4.09892 7.24852,11.54948 6.74476,18.53297 L 458.5,696.5 l -17.75,0.27307 c -17.6703,0.27185 -17.75,0.2832 -17.75,2.5275 0,8.83106 15.68472,12.85238 27.91812,7.15778 3.16151,-1.47168 5.78841,-2.15182 6.30721,-1.63302 0.489,0.489 0.75085,3.31585 0.58188,6.28188 -0.30203,5.30194 -0.37459,5.41644 -4.30721,6.79687 -6.57428,2.30771 -24.01656,2.48834 -30.12794,0.31201 z m 19.4447,-32.94479 c 0.19351,-1.36155 -0.66424,-3.20968 -2.20455,-4.75 -3.58133,-3.58133 -11.60774,-3.61668 -15.15766,-0.0667 -2.38755,2.38754 -3.1747,5.49196 -1.75302,6.91364 0.38583,0.38584 4.77333,0.57334 9.75,0.41667 8.49537,-0.26745 9.06783,-0.42109 9.36523,-2.51356 z M 330.48389,717.75 c -0.24934,-0.6875 -3.61862,-11.56825 -7.48729,-24.17944 -5.39824,-17.5973 -6.73893,-23.1167 -5.76528,-23.73469 2.07834,-1.31915 13.55051,-0.99058 14.45966,0.41413 0.44496,0.6875 2.4093,7.55 4.36519,15.25 2.28221,8.98464 4.02126,14 4.85442,14 0.7979,0 3.03116,-5.58828 5.79467,-14.5 2.47303,-7.975 5.01354,-14.83061 5.64558,-15.23469 1.53721,-0.98277 10.8256,-0.94015 12.39571,0.0569 0.6856,0.43536 1.95628,3.24097 2.82372,6.23469 5.16172,17.81409 7.68642,25.08451 8.44289,24.31313 0.46925,-0.47851 2.49072,-7.38852 4.49215,-15.35558 2.00143,-7.96706 4.169,-14.82267 4.81682,-15.23469 2.04012,-1.29751 13.69348,-0.91129 14.18881,0.47025 0.24649,0.6875 -2.84596,11.825 -6.87212,24.75 l -7.32029,23.5 -7.81441,0.29486 c -4.29792,0.16217 -8.22791,-0.11865 -8.73331,-0.62405 -0.5054,-0.5054 -2.89297,-7.33297 -5.30571,-15.17237 -4.37215,-14.20589 -5.0095,-15.78738 -5.97378,-14.82309 -0.27978,0.27977 -2.3644,6.76727 -4.6325,14.41666 -2.26809,7.6494 -4.56929,14.47049 -5.11376,15.15799 -0.64243,0.81119 -3.76638,1.25 -8.89889,1.25 -5.4187,0 -8.05168,-0.39358 -8.36228,-1.25 z m 139.98767,0.0365 c -0.27473,-0.71594 -0.38072,-16.14828 -0.23553,-34.2941 L 470.5,650.5 h 7.5 7.5 v 34 34 l -7.26446,0.2941 c -5.26234,0.21305 -7.40213,-0.0647 -7.76398,-1.00761 z m 30.98308,-0.0441 c -0.26542,-0.69168 -0.3638,-16.10418 -0.21861,-34.25 L 501.5,650.5 l 6.91048,-0.29935 c 4.85226,-0.21019 7.15597,0.0877 7.73469,1 0.9408,1.48317 1.17406,63.80388 0.24784,66.21756 -0.78137,2.03622 -14.16991,2.32676 -14.93837,0.32418 z m -42.23773,-98.58717 c -0.7057,-0.44779 -11.82044,-39.20814 -24.69942,-86.13411 -12.87899,-46.92598 -23.87435,-85.77797 -24.43413,-86.33775 -0.69039,-0.69039 -1.1827,-0.56191 -1.53045,0.39942 C 408.27096,447.86225 398.34383,484.725 386.49264,529 362.52649,618.53543 363.10071,616.51329 361.97425,615.34206 361.06811,614.39991 338,498.51084 338,494.90075 c 0,-2.84287 37.82829,-144.10664 38.87274,-145.1641 0.41468,-0.41984 16.24127,-0.64484 35.17022,-0.5 l 34.41627,0.26335 23.21636,91 c 12.76899,50.05 23.24067,91.2025 23.27038,91.45 0.44433,3.70085 5.38737,-15.86872 23.10813,-91.48547 11.59573,-49.48049 21.43467,-90.32443 21.86431,-90.76431 1.16618,-1.19399 197.04365,-0.89641 208.76058,0.31715 23.45019,2.4288 43.06431,10.93168 54.07707,23.44284 15.17088,17.23503 17.58488,46.84593 5.57939,68.43858 -4.60091,8.27503 -14.01126,17.63112 -23.25951,23.12541 -3.91162,2.32384 -7.33307,4.58282 -7.60323,5.01996 -0.27017,0.43713 3.90045,2.16625 9.26804,3.84249 18.80864,5.87371 33.21735,17.1379 40.29996,31.505 5.60958,11.37904 7.28504,20.2349 6.64224,35.10835 -0.86296,19.96758 -6.54617,33.87362 -19.44925,47.58968 -15.4209,16.3925 -33.87034,25.28519 -61.2337,29.51482 -13.9784,2.16069 -147.09877,3.38835 -149.52,1.3789 -1.29111,-1.07153 -1.48,-16.04282 -1.48,-117.30584 0,-71.23275 -0.35781,-115.71054 -0.92616,-115.12756 -0.50939,0.5225 -14.90548,52.89603 -31.99132,116.38561 -17.08583,63.48959 -31.63156,115.7952 -32.32383,116.23469 -1.65896,1.05318 -73.88094,1.03876 -75.54178,-0.0151 z M 726.218,568.98879 c 13.52369,-1.95587 25.62459,-8.81948 29.70075,-16.84624 4.60294,-9.06408 4.95453,-22.73746 0.83406,-32.43605 C 750.82251,505.748 735.14436,501.57535 691,502.20677 l -20.5,0.29323 -0.26417,32.49188 c -0.1453,17.87053 -0.0469,33.05803 0.21861,33.75 0.59833,1.55921 45.32052,1.75724 55.76356,0.24691 z m -7.71391,-115.07418 c 11.32443,-2.09343 19.77787,-8.29899 22.58432,-16.57884 0.71508,-2.10967 1.32521,-7.21077 1.35586,-11.33577 0.0463,-6.23504 -0.40988,-8.4481 -2.70488,-13.12135 -5.81541,-11.84177 -13.62678,-14.2627 -46.23939,-14.3307 l -23,-0.048 -0.26614,27.93101 c -0.20622,21.64358 0.0189,28.13157 1,28.82198 1.64808,1.15973 39.56393,0.0862 47.27023,-1.33838 z"
            id="path982" />
       </g>
     </g>
   </svg>
    </div>
  </header>
  <body>
    <div class="container">


      <div class="d-flex flex-wrap gap-3">
        <div class="   mb-3">
          <h2 class="mb-0">Données client</h2>
          <table class=" ">
            <tr>
              <th rowspan="2" class="bleu1">Site type</th>
              <td >Nombre de clients mensuels</td>
              <td class="clair"><input type="number" value="27000" id="nbclients" name="nbclients" onchange="refrechfrequentation_nbdeclientparjours()"></td>
            </tr>
            <tr>
                <td class="gris">Temps moyen d'un client (min)</td>
                <td class="marine"> <input type="number" value="30" id="tempsclient" name="tempsclient" onchange="reload()"  ></td>
            </tr>
        
            <tr>
              <th rowspan="4" class="bleu2">Abonnement <br> électrique</th>
              <td class="">Ajout d'un tarif jaune</td>
              <td class="clair"><label for="ajouttarif"></label>
                <select name="ajouttarif" id="ajouttarif" onchange="reload()">
                    <option value="OUI"  >OUI</option>
                    <option value="NON" >NON</option>
                </select>
              </td>
            </tr>
            <tr>
            
              <td class="gris">Type tarif actuel</td>
              <td class="clair"><label for="tarif"></label>

                <select name="tarif" id="tarif" onchange="reload()">
                    <option value="8000"  >Tarif jaune</option>
                    <option value="15000" >Tarif bleu</option>
                </select>
              </td>
            </tr>


            <tr>
              <td>Prix kWh en €</td>
              <td class="marine"> <input type="number" id="PrixKwh" value="0.160"  name="PrixKwh" onchange="reload()"></td>
            </tr>

          </table>
        </div>

        <div class=" ">
          <h2 class="">Proposition de revente</h2>
          <table class="">
            <thead>
              <th class="gris">Prix kWh moyen </th>
              <th class="gris">Prix achat €/kWh</th>
              <th class="gris">Prix vente €/kWh</th>
              <th class="gris">Marge de revente</th>
            </thead>
            <tbody>
              <!-- Marge de revente = Prix vente Kwh / Prix achats KWH-->
              <tr>
                <td class="bleu1">2023</td>
                <td class="textright" id=prixkwh2023 >   </td>
                <td class="marine" style="width: 70px;"> <input type="number" value="0.38" id="prixvente2023" class="w-100"  onchange="reload()"></td>
                <td class="textright"  id=marge2023></td>
              </tr>
              <tr>
                <td class="bleu2">2024 (+9%)*</td>
                <td  class="textright" id=prixkwh2024>   </td>
                <td class="textright"  id="prixvente2024"></td>
                <td class="textright" id=marge2024></td>
              </tr>
              <tr>
                <td class="bleu3">2025 (+12%)*</td>
                <td class="textright" id=prixkwh2025>   </td>
                <td  class="textright" id="prixvente2025"></td>
                <td class="textright" id=marge2025></td>
              </tr>
              <tr>
                <td class="bleu4">2026 (+15%)*</td>
                <td class="textright" id=prixkwh2026>   </td>
                <td  class="textright"id="prixvente2026"></td>
                <td class="textright" id=marge2026></td>
              </tr>
            </tbody>
          </table>
          <p class="fw-lighter fst-italic">* Evolution des tarifs d'éléctricité  en fonction des données nationnales</p>
        </div>
      </div>

      <hr>


    
      <div class="choixborne">
        <h2 class="">Bornes sélectionnées</h2>
        <table>
          <thead>
            <tr>
              <th class="gris">Référence</th>
              <th class="gris" id="nombrebornes">Nombre de bornes</th>
              <th class="gris" id="nombredecharge">Nombre total de points de chargee</th>
              <th class="gris">Type courant</th>
              <th class="gris">Type charge</th>
              <th class="gris">Puissance cumulée</th>
              <th class="gris">Prix</th>
            </tr>
            <!--Ici va s'inserer les ligne choisi avec la fonction JS-->
            <tbody id="bornes-souhaitees">


            </tbody>
            <tfoot>
              <tr>
                <th class="gris">Total</th>
                <th class="gris textright" id="nombrebornestotal">0</th>
                <th class="gris">
                  <div class="text-muted">Total AC <span id="nombrechargeAC"></span></div>
                  <div class="text-muted">Total DC <span id="nombrechargeDC"></span></div>
                  <div class="text-muted">Total AC DC <span id="nombrechargeACDC"></span></div>
                  <div>Total <span id="nombrechargetotal"></span></div>
                </th>
                <th class="gris textright" id=""></th>
                <th class="gris textright" id=""></th>
                <th class="gris textright" id="puissancecumuleetotal">0</th>
                <th class="gris textright" id="prixtotal">0</th>
              </tr>
            </tfoot>

          </thead>
        </table>
      </div>

      <br class="no-print"><br class="no-print">

      <h2 class=" no-print">Ajouter le(s) borne(s) souhaitées <button id="toggleButton" class="btn btn-light" onclick="toggleDiv()">

        <span id="arrowIcon" class=" ">v</span>

      </button></h2>
      <!-- bouto collspace pour afficher ou masquer le tableau -->



      <div id="myDiv" class="content no-print">
        <table class="table  table-striped table-hover table-borderless">
          <thead class="">
            <th class="bg-black text-white ">Descriptif</th>
            <th class="bg-black text-white">Référence</th>
            <th class="bg-black text-white">type charge</th>
            <th class="bg-black text-white">Installation</th>
            <th class="bg-black text-white">Nombre de points de charge</th>
            <th class="bg-black text-white">Puissance cumulée kW</th>
            <th class="bg-black text-white">Prix</th>
            <th class="bg-black text-white no-print"></th>
          </thead>



          <tr>
            <td>BORNE 7 KW</td>
            <td>WB-07S-SS/W</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright"> 1</td>
            <td class="textright">7</td>
            <td class="textright">891,67€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 7 KW RFID</td>
            <td>WB-07S-SS/WR</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1  </td>
            <td class="textright">7</td>
            <td class="textright">1 041,60€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 7 KW AVEC PISTOLET</td>
            <td>WB-07S-P/WR</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >7</td>
            <td class="textright" >1 183,33€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 11KW</td>
            <td>WB-11S-SS/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright">11</td>
            <td class="textright" >1 341,67€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 22KW</td>
            <td>WB-22S-SS/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >22</td>
            <td class="textright" >1 341,67€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 22 KW AVEC PISTOLET</td>
            <td>WB-22S-P/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >22</td>
            <td class="textright" >1 441,66€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE 44 KW AVEC PISTOLET</td>
            <td>WB-44S-P/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >44</td>
            <td class="textright" >2 533,33€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>STATION DOUBLE 22KW</td>
            <td>WB-22D-SS/WRL</td>
            <td>AC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >44</td>
            <td class="textright" >4 491,67€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>STATION DOUBLE 22KW AVEC PISTOLET</td>
            <td>WB-22D-P/WRL</td>
            <td>AC</td>
            <td>sol</td>
            <td class="textright">2</td>
            <td class="textright">44</td>
            <td class="textright">4 800€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DOUBLE 7KW</td>
            <td>WB-07D-SSW/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >2</td>
            <td class="textright" >14</td>
            <td class="textright" >2 775€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DOUBLE 22KW</td>
            <td>WB-22D-SSW/WRL</td>
            <td>AC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >2</td>
            <td class="textright" >44</td>
            <td class="textright" >4 083,33€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC 20KW</td>
            <td>WB-DC-20S/WRL-ECO</td>
            <td>DC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >20</td>
            <td class="textright" >6 578,64€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC 40KW</td>
            <td>WB-DC-40S/WRL</td>
            <td>DC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >1</td>
            <td class="textright" >40</td>
            <td class="textright" >9 750€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 40KW</td>
            <td>WB-DC-40D/WRLC</td>
            <td>DC</td>
            <td>mural ou sol (pied en sus)</td>
            <td class="textright" >2</td>
            <td class="textright">40</td>
            <td class="textright" >13 550€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>SUPERCHARGEUR 150KW</td>
            <td>WB-DC-150D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >150</td>
            <td class="textright" >58 500€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>SUPERCHARGEUR 180KW</td>
            <td>WB-DC-180D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright">2</td>
            <td class="textright" >180</td>
            <td class="textright" >64 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>SUPERCHARGEUR 300KW</td>
            <td>WB-DC-300D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >300</td>
            <td class="textright" >80 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>SUPERCHARGEUR 360KW</td>
            <td>WB-DC-360D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >360</td>
            <td class="textright" >90 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>STATION COMBO 44AC + 60 DC DOUBLE</td>
            <td>WB-DC-AC44S/DC60D/WC</td>
            <td>AC + DC</td>
            <td>sol</td>
            <td class="textright" >3</td>
            <td class="textright" >124</td>
            <td class="textright" >27 916,67€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 160KW</td>
            <td>WB-DC-160D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >160</td>
            <td class="textright">51 250€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>STATION COMBO 22 DC + 150 DC DOUBLE</td>
            <td>WB-DC-AC22D-SS/DC150D/WC</td>
            <td>AC + DC</td>
            <td>sol</td>
            <td class="textright" >3</td>
            <td class="textright" >172</td>
            <td class="textright" >60 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 60KW</td>
            <td>WB-DC-60D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >60</td>
            <td class="textright" >25 500€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 80KW</td>
            <td>WB-DC-80D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >80</td>
            <td class="textright" >31 625€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 100KW</td>
            <td>WB-DC-100D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >100</td>
            <td class="textright" >37 750€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 120KW</td>
            <td>WB-DC-120D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright">120</td>
            <td class="textright">43 875€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 140KW</td>
            <td>WB-DC-140D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >140</td>
            <td class="textright" >50 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
          <tr>
            <td>BORNE DC DOUBLE 160KW</td>
            <td>WB-DC-160D/WC</td>
            <td>DC</td>
            <td>sol</td>
            <td class="textright" >2</td>
            <td class="textright" >160</td>
            <td class="textright" >56 000€</td>
            <td><button class="addrow btn btn-success">+</button></td>
          </tr>
        </table>
      </div>
      <br>
      <h2 class="titretableau" style="background-color: #F55517;">ENEDIS</h2>
        <table>
          <tr>
            <td id="texttarif"></td>
            <td id="tarifValue" class="textright" style="background-color: #fb743e;">0,00€</td>
          </tr>
          
        </table>
        <i>* coût moyen 2023 estimé sur la base de plusieurs devis ENEDIS. Peu varier selon la complexité du chantier</i>
        <hr>

        <h2 class="titre_IRV no-page-break">Installation IRVE</h2>
        <table class="table table-striped">
          <tr>
            <td id="genie" class="gris">Genie civil - dalle, tranchée, percement</td>
            <td><input type = number onchange="reload()" id="IRVE1" ></td>
          </tr>
          <tr>
            <td id="moe" class="gris">MOE électrique - raccordement, ajout armoire électrique, MES</td>
            <td><input type = number onchange="reload()" id="IRVE2" ></td>
          </tr>
          <tr>
            <td id="etude" class="gris">Etude, signalisation des places, DOE, déplacement…</td>
            <td><input type = number onchange="reload()" id="IRVE3"></td>
          </tr>
          <tr>
            <td id="attestation" class="gris">Attestation de conformité bureau de contrôle</td>
            <td><input type = number onchange="reload()" id="IRVE4"></td>
          </tr>
          <tr>
            <td id="contrat"class="gris">Contrat de maintenance estimé, facturé par l’exploitant</td>
            <td class="textright" id="contrat1"></td>
          </tr>
          </tr>
        </table>
        <hr>
        <h2 class="titretableau">EV MAP – Abonnement Monétique</h2>
        <table>
          <tr>
            <td id="D1"class="gris">Service monétisation EVmap (16€/mois/PDC DC) - pour 4 ans</td>
            <td class="textright" id="DC"></td>
          </tr>
          <tr>
            <td id="AD"class="gris">Service monétisation EVmap (16€/mois/PDC AC) - pour 4 ans</td>
            <td class="textright" id="AC"></td>
          </tr>
          <tr>
            <td id="AS"class="gris">Service monétisation EVmap (16€/mois/PDC ACDC) - pour 4 ans</td>
            <td class="textright" id="AC DC"></td>
          </tr>
          <tr>
            <td id="frais"class="gris">Frais activation (60€/ point de charge)</td>
            <td class="textright" id="Totaltout"></td>
          </tr>
        </table>
        <hr>

        <h2 class="d-flex d-flex justify-content-between bg-black text-white">
          <div>Total </div>
          <div><span class="textright" id="totalglobal">  </span> </div>
        </h2>
    <br class=" no-print">
    <br class=" no-print">
    <h2 class="verneutre no-print">ESTIMATION FREQUENTATION ET CHARGE MOYENNE PAR UTILISATEUR</h2>
    <table class=" no-print">
      <thead>
        <tr>
          <th class ="vert1" >Année</th>
          <th class ="vert1" >Temps de charge (heure) par utilisateur</th>
          <th class ="vert1" >Nombre de points de charges monétisables</th>
          <th class ="vert1" >Nombre de sessions max par heure</th>
          <th class ="vert1" >Frequentation quotidienne calculée (nbre passage jour x %EV national)</th>
          <th class ="vert1" >Fréquentation quotidienne estimé</th>
          <th class ="vert1" >Charge moyenne vendue kWh/utilisateur</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="vertclair">2023</td>
          <td class="textright" id="tempscharge2023"></td>
          <td class="textright totalpointdechargesPayant" id="totalpointdechargesPayant"></td>
          <td class="textright" id="nbsession2023"></td>
          <td class="textright" id="frequentation2023"></td>
          <td class="textright" id="">
            <input type="number" id="nombredeclientjour2023" onchange="reload()">
          </td>
          <td class="chargemoyenne textright" id="chargemoyenne2023"></td>
        </tr>
        <tr>
          <td class ="vert1">2024</td>
          <td class="textright" id="tempscharge2024"></td>
          <td class="textright totalpointdechargesPayant"></td>
          <td class="textright" id="nbsession2024"></td>
          <td class="textright" id="frequentation2024"></td>
          <td class="textright" id="">
            <input type="number" id="nombredeclientjour2024" onchange="reload()">
          </td>
          <td class="chargemoyenne textright" id="chargemoyenne2024"></td>
        </tr>
        <tr>
          <td class ="verneutre" >2025</td>
          <td class="textright" id="tempscharge2025"></td>
          <td class="textright totalpointdechargesPayant"></td>
          <td class="textright" id="nbsession2025"></td>
          <td class="textright" id="frequentation2025"></td>
          <td class="textright" id="">
            <input type="number" id="nombredeclientjour2025" onchange="reload()">
          </td>
          <td class="chargemoyenne textright" id="chargemoyenne2025"></td>
        </tr>
        <tr>
          <td class ="vertfonce">2026</td>
          <td class="textright" id="tempscharge2026"></td>
          <td class="textright totalpointdechargesPayant"></td>
          <td class="textright" id="nbsession2026"></td>
          <td class="textright" id="frequentation2026"></td>
          <td class="textright" id="">
            <input type="number" id="nombredeclientjour2026" onchange="reload()">
          </td>
          <td class="chargemoyenne textright" id="chargemoyenne2026"></td>
        </tr>
      </tbody>
    </table>
    <br>
    <h2 class="verneutre no-print">Marges €HT par session de charge moyenne</h2>
    <table class="no-print">
      <thead>
        <tr>
          <th class ="vert1" >Année</th>
          <th class ="vert1" >Prix de revient €HT par charge unitaire</th>
          <th class ="vert1" >Prix revente €HT/charge unitaire</th>
          <th class ="vert1" >Marge €HT/charge unitaire</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="vertclair" >2023</td>
          <td class="textright" id="prixrevient2023"></td>
          <td class="textright" id="prixrevente2023"></td>
          <td class="textright" id="margeunit2023"></td>
        </tr>
        <tr>
          <td class ="vert1">2024</td>
          <td class="textright" id="prixrevient2024"></td>
          <td class="textright" id="prixrevente2024"></td>
          <td class="textright" id="margeunit2024"></td>
        </tr>
        <tr>
          <td class="verneutre" >2025</td>
          <td class="textright" id="prixrevient2025"></td>
          <td class="textright" id="prixrevente2025"></td>
          <td class="textright" id="margeunit2025"></td>
        </tr>
        <tr>
          <td class="vertfonce" >2026</td>
          <td class="textright" id="prixrevient2026"></td>
          <td class="textright" id="prixrevente2026"></td>
          <td class="textright" id="margeunit2026"></td>
        </tr>
      </tbody>
    </table>
    <br class="no-print">
    <h2 class="verneutre no-print">Marge totale €HT annuelle</h2>
    <table class="no-print">
      <thead>
        <tr>
          <th class ="vert1" >Année</th>
          <th class ="vert1" >Marge annuelle opérationnelle brute €HT</th>
          <th class ="vert1" >Coût EV map €HT (8,5% sur volume de vente)</th>
          <th class ="vert1" >Marge brute annuelle €HT</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="vertclair" >2023</td>
          <td class="textright" id="margeopera2023"></td>
          <td class="textright" id="coutevmap2023"></td>
          <td class="textright" id="margebrute2023"></td>
        </tr>
        <tr>
          <td class ="vert1">2024</td>
          <td class="textright" id="margeopera2024"></td>
          <td class="textright" id="coutevmap2024"></td>
          <td class="textright" id="margebrute2024"></td>
        </tr>
        <tr>
          <td class="verneutre" >2025</td>
          <td class="textright" id="margeopera2025"></td>
          <td class="textright" id="coutevmap2025"></td>
          <td class="textright" id="margebrute2025"></td>
        </tr>
        <tr>
          <td class="vertfonce" >2026</td>
          <td class="textright" id="margeopera2026"></td>
          <td class="textright" id="coutevmap2026"></td>
          <td class="textright" id="margebrute2026"></td>
        </tr>
      </tbody>
    </table>
    <br class="no-print">
    <h2 class="verneutre">MARGE TOTAL ANNUELLE</h2>
    <table>
      <thead>
        <tr>
          <th class ="vert1" >Année</th>
          <th class="vert1">Marge annuelle brute cumulée €HT</th>
          <th class ="vert1">Coût €HT cumulé des travaux (amortissement 48 mois)</th>
          <th class="vert1">Marge nette €HT cumulée</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="vertclair" >2023</td>
          <td class="textright" id="margebrutcumule2023"></td>
          <td class="textright" id="travauxcumulee2023"></td>
          <td class="textright" id="magenetcumulee2023"></td>
        </tr>
        <tr>
          <td class ="vert1" >2024</td>
          <td class="textright" id="margebrutcumule2024"></td>
          <td class="textright" id="travauxcumulee2024"></td>
          <td class="textright" id="magenetcumulee2024"></td>    </tr>
        <tr>
          <td class="verneutre">2025</td>
          <td class="textright" id="margebrutcumule2025"></td>
          <td class="textright" id="travauxcumulee2025"></td>
          <td class="textright" id="magenetcumulee2025"></td>    </tr>
        <tr>
          <td class="vertfonce">2026</td>
          <td class="textright" id="margebrutcumule2026"></td>
          <td class="textright" id="travauxcumulee2026"></td>
          <td class="textright" id="magenetcumulee2026"></td>    </tr>
      </tbody>
    </table>
    <hr>
    <h2 class="d-flex d-flex justify-content-between bg-black text-white ">
      <div>Temps de retour sur investissement  </div>
      <div><span class="textright" id="tempsretour">  </span> mois</div>
    </h2>
    <br class="no-print">
    <br class="no-print">
    <div class="d-flex d-flex justify-content-center no-print m-3 text-center no-print"> 
      <button id="emailButton" class="btn btn btn-info m-3 no-print">Envoyer demande par email</button>
      <br>
      <button class="btn btn-info m-3 no-print" onclick="window.print()">Imprimer</button>
    </div>




    
    
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>
  <!--script2-->
  <script>            
          //affichage du tableau des bornes a choisir
          function toggleDiv() {
            var div = document.getElementById("myDiv");
            var arrowIcon = document.getElementById("arrowIcon");

            if (arrowIcon.innerHTML === "v") {
              arrowIcon.innerHTML = "&#62;";
              div.style.display = "none";
            } else {
              arrowIcon.innerHTML = "v";
              div.style.display = "block";
            }
          }

          // ecoutes des bouton + du tableau QUELLE TYPE DE BORNE CHOISIR ? ?
          for (let btn of document.getElementsByClassName('addrow')) {
            btn.addEventListener('click', function() {
              ajouterLigne(btn);
            });
          }
          function calcultotalprix() {
            var elementsPrix = document.getElementsByClassName("prix");
            var totalPrix = 0.00;
            var valeur = 0.00;
            var prixtotalcell = document.getElementById("prixtotal");
            for (var i = 0; i < elementsPrix.length; i++) {
              valeur = parseFloat(elementsPrix[i].innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
              console.log("valeur", valeur); 
              if (!isNaN(valeur)) {
                totalPrix += valeur;
                
              }
            }
            prixtotalcell.textContent = formatNumber(totalPrix,2);

          }


            // Mettre à jour la valeur dans la balise th



          //calcul ligne des total
          function calculerNombreBornesTotal() {
            // Récupérer tous les éléments input avec name="nombrebornes"
            var elements = document.getElementsByName("nombrebornes");
            var total = 0;


            // Parcourir les éléments et additionner leurs valeurs
            for (var i = 0; i < elements.length; i++) {
              var valeur = parseInt(elements[i].value);
              if (!isNaN(valeur)) {
                total += valeur;
              }
            }
            // Mettre à jour la valeur dans la balise th
            var baliseTotal = document.getElementById("nombrebornestotal");
            baliseTotal.textContent = total;

            // Mettre à jour le nombre total charges
            var elementspointdecharges = document.getElementsByName("nombredecharge");
            var totalpointdecharges = 0;

            for (var i = 0; i < elementspointdecharges.length; i++) {
              var valeur = parseInt(elementspointdecharges[i].textContent);
              if (!isNaN(valeur)) {
                totalpointdecharges += valeur;
              }
            }

              var baliseTotal = document.getElementById("nombrechargetotal");
              var baliseTotalAC = document.getElementById("nombrechargeAC");
              var baliseTotalDC = document.getElementById("nombrechargeDC");
              var baliseTotalACDC = document.getElementById("nombrechargeACDC");
              totalpointdechargesAC = 0;
              totalpointdechargesDC = 0;
              totalpointdechargesACDC = 0;
              totalpointdechargesAbonnement = 0;
              totalpuissancecumuleAbonnement = 0;
              totalpointdechargesPayant = 0;
              totalpuissancecumulePayant =0;


              var rows = document.querySelectorAll("#bornes-souhaitees .marine");
              for (var i = 0; i < rows.length; i += 7) {
                type = rows[i + 3].textContent;
                points = parseInt(rows[i + 2].textContent);
                typecontrat = rows[i + 4].querySelector("select").value;
                nombredeborne = parseInt(rows[i + 2].textContent)
                puissanceCumule  = parseInt(rows[i + 5].textContent)
                
                if (type === "AC") {
                  totalpointdechargesAC += points;
                }
                if (type === "DC") {
                  totalpointdechargesDC += points;
                }
                if (type === "AC + DC") {
                  totalpointdechargesACDC += points;
                }
                if (typecontrat === "Abonnement") {
                  totalpointdechargesAbonnement += nombredeborne;
                  totalpuissancecumuleAbonnement += puissanceCumule
                }
                if (typecontrat === "Payant") {
                  totalpointdechargesPayant += nombredeborne;
                  totalpuissancecumulePayant += puissanceCumule
                }
              }

              let nb_point_charges = document.querySelectorAll(".totalpointdechargesPayant");
              nb_point_charges.forEach(element => {
                element.innerText = totalpointdechargesPayant;
              })
              var tempsclient = document.getElementById("tempsclient").value
              //console.log(tempsclient)
              if ((totalpuissancecumulePayant * tempsclient / 60)>50) {
                var totalpuissancecumulePayant2023 = 50
                var totalpuissancecumulePayant2024 = 70
                var totalpuissancecumulePayant2025 = 80
                var totalpuissancecumulePayant2026 = 100
              } else {
                var totalpuissancecumulePayant2023 = totalpuissancecumulePayant * tempsclient /60
                var totalpuissancecumulePayant2024 = totalpuissancecumulePayant * tempsclient /60
                var totalpuissancecumulePayant2025 = totalpuissancecumulePayant * tempsclient /60
                var totalpuissancecumulePayant2026 = totalpuissancecumulePayant * tempsclient /60
              }
              document.getElementById("chargemoyenne2023").innerText = totalpuissancecumulePayant2023.toFixed(2);
              document.getElementById("chargemoyenne2024").innerText = totalpuissancecumulePayant2024.toFixed(2);
              document.getElementById("chargemoyenne2025").innerText = totalpuissancecumulePayant2025.toFixed(2);
              document.getElementById("chargemoyenne2026").innerText = totalpuissancecumulePayant2026.toFixed(2);



              baliseTotal.textContent = totalpointdecharges;
              baliseTotalAC.textContent = totalpointdechargesAC;
              baliseTotalDC.textContent = totalpointdechargesDC;
              baliseTotalACDC.textContent = totalpointdechargesACDC;


              var contrat1 = document.getElementById("contrat1");
              contrat1.innerText = ((totalpointdechargesAC * 300) + (totalpointdechargesDC * 500) + (totalpointdechargesACDC*600))*4 + "€";
              var DC = document.getElementById("DC");
              DC.innerText = (totalpointdechargesDC*16*12*4)+"€";
              var AC = document.getElementById("AC");
              AC.innerText = (totalpointdechargesAC*16*12*4)+"€";
              var ACDC = document.getElementById("AC DC");
              ACDC.innerText = (totalpointdechargesACDC*16*12*4)+"€";
              var Totaltout = document.getElementById("Totaltout");
              Totaltout.innerText = (totalpointdecharges*60)+"€";

            }

          function totalpuissancecumulee() {
            var elementsPuissanceCumulee = document.getElementsByClassName("puissance_cumulee");
            var totalPuissanceCumulee = 0;

            for (var i = 0; i < elementsPuissanceCumulee.length; i++) {
              var valeur = parseInt(elementsPuissanceCumulee[i].innerText);
              if (!isNaN(valeur)) {
                totalPuissanceCumulee += valeur;
              }
            }
            var baliseTotal = document.getElementById("puissancecumuleetotal");
            baliseTotal.textContent = totalPuissanceCumulee;
            
          }


          //remplissage tbl proposition de revente (prix KWH moyen)
          function updateMarge2023() {
            var prixkwh2023Cell = document.getElementById("prixkwh2023");
            var prixvente2024Cell = document.getElementById("prixvente2024");
            var prixvente2025Cell = document.getElementById("prixvente2025");
            var prixvente2026Cell = document.getElementById("prixvente2026");
            var prixkwh2024Cell = document.getElementById("prixkwh2024");
            var prixkwh2025Cell = document.getElementById("prixkwh2025");
            var prixkwh2026Cell = document.getElementById("prixkwh2026");
            var marge2023Cell = document.getElementById("marge2023");
            var marge2024Cell = document.getElementById("marge2024");
            var marge2025Cell = document.getElementById("marge2025");
            var marge2026Cell = document.getElementById("marge2026");
            var prixkwh = parseFloat(prixkwhInput.value);
            var prixkwh2024  = prixkwh + prixkwh* 9/100;
            var prixkwh2025  = prixkwh2024 + prixkwh2024* 12/100;
            var prixkwh2026  = prixkwh2025 + prixkwh2025* 15/100;


            var prixvente2023 = parseFloat(prixvente2023Input.value);
            prixvente2024Cell.innerText = formatNumber(prixvente2023,2);
            prixvente2025Cell.innerText = formatNumber(prixvente2023,2);
            prixvente2026Cell.innerText = formatNumber(prixvente2023,2);

            if (!isNaN(prixkwh) && !isNaN(prixvente2023)) {
              var marge2023 = prixvente2023 / prixkwh;
              marge2023Cell.innerText = formatNumber(marge2023,2);
              prixkwh2023Cell.innerText = formatNumber(prixkwh,3);
            }
            if (!isNaN(prixkwh2024) && !isNaN(prixvente2023)) {
              var marge2024 = prixvente2023 / prixkwh2024;
              marge2024Cell.innerText = formatNumber(marge2024,2);
              prixkwh2024Cell.innerText = formatNumber(prixkwh2024,3);
            }
            if (!isNaN(prixkwh2025) && !isNaN(prixvente2023)) {
              var marge2025 = prixvente2023 / prixkwh2025;
              marge2025Cell.innerText = formatNumber(marge2025,2);
              prixkwh2025Cell.innerText = formatNumber(prixkwh2025,3);
            }
            if (!isNaN(prixkwh2026) && !isNaN(prixvente2023)) {
              var marge2026 = prixvente2023 / prixkwh2026;
              marge2026Cell.innerText = formatNumber(marge2026,2);
              prixkwh2026Cell.innerText = formatNumber(prixkwh2026,3);
            }

          }




          //12/15/20

          //calcul pour tableau Proposition de revente
          var prixkwhInput = document.getElementById("PrixKwh");
          var prixvente2023Input = document.getElementById("prixvente2023");
          prixkwhInput.addEventListener("change", updateMarge2023);
          prixvente2023Input.addEventListener("change", updateMarge2023);


          function displayTarifValue() {
                var tarifSelect = document.getElementById("tarif").value;
                var tarifValue = document.getElementById("tarifValue");
                var texttarif = document.getElementById("texttarif");
                var ajouttarif = document.getElementById("ajouttarif").value;

                if (ajouttarif === "NON") {
                  tarifValue.innerHTML = "0 €";
                  texttarif.innerHTML = "Utilisation du tarif existant";
                }
                else if (tarifSelect === "8000") {
                  tarifValue.innerHTML = "8000 €";
                  texttarif.innerHTML = "PDL ENEDIS Tarif Jaune *";
                } else if (tarifSelect === "15000") {
                  tarifValue.innerHTML = "15000";
                  texttarif.innerHTML = "PDL ENEDIS Tarif Bleu *";
                } else {
                  tarifValue.innerHTML = "errore select tarif";
                  texttarif.innerHTML = "errore select tarif";
                }
                
          }


          function calculglobal() {

            var elements = [
              parseFloat(document.getElementById("prixtotal").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("tarifValue").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("IRVE1").value),
              parseFloat(document.getElementById("IRVE2").value),
              parseFloat(document.getElementById("IRVE3").value),
              parseFloat(document.getElementById("IRVE4").value),
              parseFloat(document.getElementById("contrat1").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("DC").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("AC").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("AC DC").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
              parseFloat(document.getElementById("Totaltout").innerText.replace(/[^\d,.-]/g, '').replace(",", ".")),
            ]

            let total = 0;
            for (let elm of elements) {
              const val = parseFloat(elm)
              if (isNaN(val)) continue;
              total += val;
              console.log(total + " " + val);
            }

            document.getElementById("totalglobal").innerText = formatNumber(total,2);
          }


          //rempli tableau POTENTIEL ANNUEL DE VENTE KWH pour Borne par type "PAYANT"
          function remplissageTBLpotentielannuel() {
            //1ere colonne
            var tempscharge2023Cell = document.getElementById("tempscharge2023");
            var tempscharge2024Cell = document.getElementById("tempscharge2024");
            var tempscharge2025Cell = document.getElementById("tempscharge2025");
            var tempscharge2026Cell = document.getElementById("tempscharge2026");
            var totalpointdechargesPayant = parseInt(document.getElementById("totalpointdechargesPayant").innerText);

            var tempsclient = parseFloat(document.getElementById("tempsclient").value);
            var tempscharge2023  = tempsclient / 60;
            var tempscharge2024  = tempsclient / 60;
            var tempscharge2025  = tempsclient / 60;
            var tempscharge2026  = tempsclient / 60;


            tempscharge2023Cell.innerHTML = tempscharge2023.toFixed(2);
            tempscharge2024Cell.innerHTML = tempscharge2024.toFixed(2);
            tempscharge2025Cell.innerHTML = tempscharge2025.toFixed(2);
            tempscharge2026Cell.innerHTML = tempscharge2026.toFixed(2);

            //calculernbsession 3eme colonne
            var nbsession2023 = document.getElementById("nbsession2023");
            var nbsession2024 = document.getElementById("nbsession2024");
            var nbsession2025 = document.getElementById("nbsession2025");
            var nbsession2026 = document.getElementById("nbsession2026");

            nbsession2023.innerHTML = (totalpointdechargesPayant/ tempscharge2023);
            nbsession2024.innerHTML = (totalpointdechargesPayant / tempscharge2024);
            nbsession2025.innerHTML = (totalpointdechargesPayant / tempscharge2025);
            nbsession2026.innerHTML = (totalpointdechargesPayant / tempscharge2026);
            //calculernbsession 4eme colonne

          }

          function refrechfrequentation_nbdeclientparjours() {
            var frequentation2023Cell = document.getElementById("frequentation2023");
            var frequentation2024Cell = document.getElementById("frequentation2024");
            var frequentation2025Cell = document.getElementById("frequentation2025");
            var frequentation2026Cell = document.getElementById("frequentation2026");
            var nbclients = parseInt(document.getElementById("nbclients").value);
            //Part EV seul 202
            var frequentation2023 = (parseFloat(nbclients / 30) * 2 / 100).toFixed(0);
            var frequentation2024 = (parseFloat(nbclients / 30) * 4 / 100).toFixed(0);
            var frequentation2025 = (parseFloat(nbclients / 30) * 6 / 100).toFixed(0);
            var frequentation2026 = (parseFloat(nbclients / 30) * 9/ 100).toFixed(0);
            frequentation2023 = frequentation2023 > 0 ? frequentation2023 : 1;
            frequentation2024 = frequentation2024 > 0 ? frequentation2024 : 1;
            frequentation2025 = frequentation2025 > 0 ? frequentation2025 : 1;
            frequentation2026 = frequentation2026 > 0 ? frequentation2026 : 1;
            frequentation2023Cell.innerHTML = frequentation2023;
            frequentation2024Cell.innerHTML = frequentation2024;
            frequentation2025Cell.innerHTML = frequentation2025;
            frequentation2026Cell.innerHTML = frequentation2026;

            document.getElementById("nombredeclientjour2023").value = frequentation2023;
            document.getElementById("nombredeclientjour2024").value = frequentation2024;
            document.getElementById("nombredeclientjour2025").value = frequentation2025;
            document.getElementById("nombredeclientjour2026").value = frequentation2026;
            reload();
          }


          function remplissageTBLMargesParChargeUnitaire() {
            // Cellules à remplir
            var prixrevient2023Cell = document.getElementById("prixrevient2023");
            var prixrevient2024Cell = document.getElementById("prixrevient2024");
            var prixrevient2025Cell = document.getElementById("prixrevient2025");
            var prixrevient2026Cell = document.getElementById("prixrevient2026");

            // Cellules utilisées pour le calcul
            var prixkwh2023 = parseFloat(document.getElementById("prixkwh2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixkwh2024 = parseFloat(document.getElementById("prixkwh2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixkwh2025 = parseFloat(document.getElementById("prixkwh2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixkwh2026 = parseFloat(document.getElementById("prixkwh2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var chargemoyenne2023 = parseFloat(document.getElementById("chargemoyenne2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var chargemoyenne2024 = parseFloat(document.getElementById("chargemoyenne2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var chargemoyenne2025 = parseFloat(document.getElementById("chargemoyenne2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var chargemoyenne2026 = parseFloat(document.getElementById("chargemoyenne2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));

            // Mes calculs
            prixrevient2023Cell.innerText = formatNumber((chargemoyenne2023 * prixkwh2023), 2);
            prixrevient2024Cell.innerText = formatNumber((chargemoyenne2024 * prixkwh2024),2);
            prixrevient2025Cell.innerText = formatNumber((chargemoyenne2025 * prixkwh2025),2);
            prixrevient2026Cell.innerText = formatNumber((chargemoyenne2026 * prixkwh2026),2);
            // Cellules à remplir
            var prixrevente2023Cell = document.getElementById("prixrevente2023");
            var prixrevente2024Cell = document.getElementById("prixrevente2024");
            var prixrevente2025Cell = document.getElementById("prixrevente2025");
            var prixrevente2026Cell = document.getElementById("prixrevente2026");
            var prixvente2023 = parseFloat(document.getElementById("prixvente2023").value);
            var prixvente2024 = parseFloat(document.getElementById("prixvente2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixvente2025 = parseFloat(document.getElementById("prixvente2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixvente2026 = parseFloat(document.getElementById("prixvente2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));


            prixrevente2023Cell.innerText = formatNumber((prixvente2023 * chargemoyenne2023),2);
            prixrevente2024Cell.innerText = formatNumber((prixvente2024 * chargemoyenne2024),2);
            prixrevente2025Cell.innerText = formatNumber((prixvente2025 * chargemoyenne2025),2);
            prixrevente2026Cell.innerText = formatNumber((prixvente2026 * chargemoyenne2026),2);

            var margeunit2023Cell = document.getElementById("margeunit2023");
            var margeunit2024Cell = document.getElementById("margeunit2024");
            var margeunit2025Cell = document.getElementById("margeunit2025");
            var margeunit2026Cell = document.getElementById("margeunit2026");
            var prixrevente2023 = parseFloat(document.getElementById("prixrevente2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2024 = parseFloat(document.getElementById("prixrevente2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2025 = parseFloat(document.getElementById("prixrevente2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2026 = parseFloat(document.getElementById("prixrevente2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevient2023 = parseFloat(document.getElementById("prixrevient2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevient2024 = parseFloat(document.getElementById("prixrevient2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevient2025 = parseFloat(document.getElementById("prixrevient2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevient2026 = parseFloat(document.getElementById("prixrevient2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            margeunit2023Cell.innerText = formatNumber((prixrevente2023 - prixrevient2023),2);
            margeunit2024Cell.innerText = formatNumber((prixrevente2024 - prixrevient2024),2);
            margeunit2025Cell.innerText = formatNumber((prixrevente2025 - prixrevient2025),2);
            margeunit2026Cell.innerText = formatNumber((prixrevente2026 - prixrevient2026),2);


          }
          function remplissageTBLMargesAnnuelle() {
            //celluel a remplir
            var margeopera2023Cell = document.getElementById("margeopera2023");
            var margeopera2024Cell = document.getElementById("margeopera2024");
            var margeopera2025Cell = document.getElementById("margeopera2025");
            var margeopera2026Cell = document.getElementById("margeopera2026");

            var margebrute2023Cell = document.getElementById("margebrute2023");
            var margebrute2024Cell = document.getElementById("margebrute2024");
            var margebrute2025Cell = document.getElementById("margebrute2025");
            var margebrute2026Cell = document.getElementById("margebrute2026");

            var coutevmap2023Cell = document.getElementById("coutevmap2023");
            var coutevmap2024Cell = document.getElementById("coutevmap2024");
            var coutevmap2025Cell = document.getElementById("coutevmap2025");
            var coutevmap2026Cell = document.getElementById("coutevmap2026");


                ///cellules tbl sur investissement
                var margebrutcumule2023Cell = document.getElementById("margebrutcumule2023");
                var margebrutcumule2024Cell = document.getElementById("margebrutcumule2024");
                var margebrutcumule2025Cell = document.getElementById("margebrutcumule2025");
                var margebrutcumule2026Cell = document.getElementById("margebrutcumule2026");
                var travauxcumulee2023Cell = document.getElementById("travauxcumulee2023");
                var travauxcumulee2024Cell = document.getElementById("travauxcumulee2024");
                var travauxcumulee2025Cell = document.getElementById("travauxcumulee2025");
                var travauxcumulee2026Cell = document.getElementById("travauxcumulee2026");
                var magenetcumulee2023Cell = document.getElementById("magenetcumulee2023");
                var magenetcumulee2024Cell = document.getElementById("magenetcumulee2024");
                var magenetcumulee2025Cell = document.getElementById("magenetcumulee2025");
                var magenetcumulee2026Cell = document.getElementById("magenetcumulee2026");
                //dernier ligne temps de retour
                var tempsretourCell = document.getElementById("tempsretour");






            //variable pour calcul
            var prixrevente2023 = parseFloat(document.getElementById("prixrevente2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2024 = parseFloat(document.getElementById("prixrevente2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2025 = parseFloat(document.getElementById("prixrevente2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var prixrevente2026 = parseFloat(document.getElementById("prixrevente2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var margeunit2023 = parseFloat(document.getElementById("margeunit2023").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var margeunit2024 = parseFloat(document.getElementById("margeunit2024").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var margeunit2025 = parseFloat(document.getElementById("margeunit2025").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var margeunit2026 = parseFloat(document.getElementById("margeunit2026").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));
            var nombredeclientjour2023 = parseInt(document.getElementById("nombredeclientjour2023").value);
            var nombredeclientjour2024 = parseInt(document.getElementById("nombredeclientjour2024").value);
            var nombredeclientjour2025 = parseInt(document.getElementById("nombredeclientjour2025").value);
            var nombredeclientjour2026 = parseInt(document.getElementById("nombredeclientjour2026").value);
            var totalglobal = parseFloat(document.getElementById("totalglobal").innerText.replace(/[^\d,.-]/g, '').replace(",", "."));

            var margeopera2023 = (margeunit2023 * nombredeclientjour2023*30*12)
            var margeopera2024 = (margeunit2024 * nombredeclientjour2024*30*12)
            var margeopera2025 = (margeunit2025 * nombredeclientjour2025*30*12)
            var margeopera2026 = (margeunit2026 * nombredeclientjour2026*30*12)

            var coutevmap2023 = (prixrevente2023 * nombredeclientjour2023*30*12*0.085);
            var coutevmap2024 = (prixrevente2024 * nombredeclientjour2024*30*12*0.085);
            var coutevmap2025 = (prixrevente2025 * nombredeclientjour2025*30*12*0.085);
            var coutevmap2026 = (prixrevente2026 * nombredeclientjour2026*30*12*0.085);

            //renvoie au cellules


            margeopera2023Cell.innerText = formatNumber(margeopera2023,2);
            margeopera2024Cell.innerText = formatNumber(margeopera2024,2);
            margeopera2025Cell.innerText = formatNumber(margeopera2025,2);
            margeopera2026Cell.innerText = formatNumber(margeopera2026,2);

            coutevmap2023Cell.innerText = formatNumber(coutevmap2023,2);
            coutevmap2024Cell.innerText = formatNumber(coutevmap2024,2);
            coutevmap2025Cell.innerText = formatNumber(coutevmap2025,2);
            coutevmap2026Cell.innerText = formatNumber(coutevmap2026,2);

            var margebrut2023 = (margeopera2023 - coutevmap2023)
            var margebrut2024 = (margeopera2024 - coutevmap2024)
            var margebrut2025 = (margeopera2025 - coutevmap2025)
            var margebrut2026 = (margeopera2026 - coutevmap2026)

            margebrute2023Cell.innerText = formatNumber(margebrut2023,2);
            margebrute2024Cell.innerText = formatNumber(margebrut2024,2);
            margebrute2025Cell.innerText = formatNumber(margebrut2025,2);
            margebrute2026Cell.innerText = formatNumber(margebrut2026,2);



            travauxcumulee2023Cell.innerText = formatNumber((totalglobal * 0.25),2);
            travauxcumulee2024Cell.innerText = formatNumber((totalglobal * 0.50),2);
            travauxcumulee2025Cell.innerText = formatNumber((totalglobal * 0.75),2);
            travauxcumulee2026Cell.innerText = formatNumber((totalglobal),2);

            //remplissage tbl retour sur investissement
            var mbcu2023 = 0
            var mbcu2024 = 0
            var mbcu2025 = 0
            var mbcu2026 = 0

            mbcu2023 =  margebrut2023;
            mbcu2024 =  mbcu2023 + margebrut2024;
            mbcu2025 =   margebrut2023 +margebrut2024 +margebrut2025;
            mbcu2026 = margebrut2023 +margebrut2024 +margebrut2025+ margebrut2026;

            margebrutcumule2023Cell.innerText = formatNumber(mbcu2023,2)
            margebrutcumule2024Cell.innerText = formatNumber(mbcu2024,2)
            margebrutcumule2025Cell.innerText = formatNumber(mbcu2025,2)
            margebrutcumule2026Cell.innerText = formatNumber(mbcu2026,2)


            magenetcumulee2023Cell.innerText = formatNumber((mbcu2023 - (totalglobal * 0.25)),2);
            magenetcumulee2024Cell.innerText = formatNumber((mbcu2024 - (totalglobal * 0.50)),2);
            magenetcumulee2025Cell.innerText = formatNumber((mbcu2025 - (totalglobal * 0.75)),2);
            magenetcumulee2026Cell.innerText = formatNumber((mbcu2026 - (totalglobal)),2);
              //colorisation des cellules
            const magnets = ["magenetcumulee2023", "magenetcumulee2024", "magenetcumulee2025", "magenetcumulee2026"];
            for (const magnet of magnets) {
              const magnetCumulee = document.getElementById(magnet);
              const magnetCumuleeValue = magnetCumulee.innerText.replace(/[^\d,.-]/g, '').replace(",", ".");
            
              if (magnetCumuleeValue > 0) {
                magnetCumulee.classList.add("text-green");
                magnetCumulee.classList.remove("text-red");
              } else {
                magnetCumulee.classList.add("text-red");
                magnetCumulee.classList.remove("text-green");
              }
            }
            //remplissager retour su rinvestissement
            if (mbcu2026 != 0){
            tempsretourCell.innerText = (totalglobal * 48 / mbcu2026).toFixed(2);
            }


          }

  </script>
  <!-- script -->
  <script>
            function formatNumber(value, decimals) {
            // Utiliser la fonction toLocaleString pour ajouter le séparateur des milliers
            let formattedValue = value.toLocaleString(undefined, {
              minimumFractionDigits: decimals,
              maximumFractionDigits: decimals,
            });

            // Ajouter le symbole "€" à la fin
            formattedValue += "€";

            return formattedValue;
          }
          
          // bouton + sur tableau QUELLE TYPE DE BORNE CHOISIR ?
          function ajouterLigne(button) {
            var row = button.parentNode.parentNode ;
            var reference = row.cells[0].innerText + " [" + row.cells[1].innerText + "]";
            var nombrecharge = row.cells[4].innerText;
            var puissanceCumulee = row.cells[5].innerText;
            var typecharge = row.cells[2].innerText;
            var prix = row.cells[6].innerText;

            var tableContainer = document.querySelector('.choixborne');
            var table = tableContainer.querySelector('#bornes-souhaitees');
            var newRow = table.insertRow();
            newRow.classList.add("selectedRows")

            newRow.innerHTML =
              '<td class="marine" >' + reference + '</td>' +
              '<td class="marine textright" ><input type="number" name="nombrebornes" min="0" max="10" value="1" data-point-charge="'+nombrecharge+'" data-puissance="'+puissanceCumulee+'" data-prix="'+prix+'" onKeyDown="return false"></td>' +
              '<td class="marine textright totalpoint" name="nombredecharge">' + nombrecharge + '</td>' +
              '<td class="marine ">' + typecharge + '</td>' +
              '<td class="marine ">  <select name="typechargeprix" id="typechargeprix" onchange="reload()"> <option value="Payant">Payant</option><option value="Abonnement" >Abonnement</option></select> </td>' +
              '<td class="marine  textright puissance_cumulee ">' + puissanceCumulee + '</td>' +
              '<td class="marine textright prix">' + prix + '</td>';

            tableContainer.scrollTop = tableContainer.scrollHeight;

            // Ajouter le bouton de suppression à la nouvelle ligne
            var deleteButtonCell = newRow.insertCell();
            var deleteButton = document.createElement('button');
            deleteButton.className = 'delrow btn btn-danger no-print';
            deleteButton.textContent = '-';
            deleteButton.addEventListener('click', function() {
              supprimerLigne(this);
            });
            deleteButtonCell.appendChild(deleteButton);

            newRow.querySelector("input").addEventListener("change", function() {
              var input = this;

              var nombreBornes = parseInt(input.value);
              rowpointdecharge = parseInt(input.getAttribute("data-point-charge"));
              rowpuissance = parseInt(input.getAttribute("data-point-charge"));
              rowprix = parseFloat(input.getAttribute("data-prix"));


              //var totalPointCell = input.parentNode.nextElementSibling;
              var totalPointchargeCell = newRow.querySelector('.totalpoint');
              var puissanceCumuleeCell = newRow.querySelector('.puissance_cumulee');
              var totalprixCell = newRow.querySelector('.prix');

              var nombrecharges = rowpointdecharge * nombreBornes;
              totalPointchargeCell.innerText = nombrecharges;
              puissanceCumuleeCell.innerText = nombreBornes * puissanceCumulee;
              totalprixCell.innerText =  (rowprix * nombreBornes).toFixed(2)


              reload();

            });

            reload();
            initTypeCharge(newRow);

          }


          // bouton - sur tableau Nombre de bornes souhaités ?
          function supprimerLigne(button) {
            var row = button.parentNode.parentNode;
            var table = row.parentNode;
            table.removeChild(row);

            reload();

          }

          function setChargeValue(row,choice) {
            let totalpoints = parseInt(row.querySelector(".totalpoint").innerText);
            if (choice == "Abonnement") {
              row.dataset.chargeVal = 0;
            } else {
              //calcul si "Payant"
              row.dataset.chargeVal = totalpoints;
            }

          }
          function initTypeCharge(row) {
            let inputs = row.querySelectorAll("input, select");
            let choice = row.querySelector("[name='typechargeprix']")

            let totalpoints = parseInt(row.querySelector(".totalpoint").innerText);
            row.dataset.chargeVal = totalpoints;

            for (let input of inputs) {
              input.addEventListener("change", function(e) {
                setChargeValue(row,choice.value);
                getTotalCharges();
              })
            }

            getTotalCharges();

          }

          function getTotalCharges() {
            let nb_point_charges = document.querySelectorAll(".nbpointcharges");
            let selectedRows = document.querySelectorAll(".selectedRows");
            let total = 0;
            for (let row of selectedRows) {
              total+= parseInt(row.dataset.chargeVal);
            }

            nb_point_charges.forEach(element => {
              element.innerText = total;
            })
          }

          function displaybtnemail() {
              // Sélection de l'élément du bouton et de l'élément tbody
            var emailButton = document.getElementById("emailButton");
            var tbodyElement = document.getElementById("bornes-souhaitees");

            // Vérification du nombre d'éléments tr dans le tbody lors du chargement de la page
            
              var trElements = tbodyElement.getElementsByTagName("tr");
              if (trElements.length === 0) {
                emailButton.style.display = "none"; // Masquer le bouton s'il n'y a pas d'éléments tr
              }
              else  {
                emailButton.style.display = "block"; // Afficher le bouton s'il y a des éléments tr
              }
              console.log("trElements.length", trElements.length);

          }


          function reload() {
            console.log("reload function")
            updateMarge2023();
            calcultotalprix();
            calculerNombreBornesTotal();
            totalpuissancecumulee();
            displayTarifValue();
            calculglobal();
            remplissageTBLpotentielannuel();
            remplissageTBLMargesParChargeUnitaire();
            remplissageTBLMargesAnnuelle();
            displaybtnemail();

          }


          refrechfrequentation_nbdeclientparjours();
      
  </script>
  <!-- scriptemail -->
  <script>
          // script envoie email-->

          document.getElementById("emailButton").addEventListener("click", function() {
          var borneschoisiElement = document.getElementById("bornes-souhaitees");
          var trElements = borneschoisiElement.getElementsByTagName("tr");
          var recipient = "contact@artixium.com";
          var subject = "Demande de devis WELLBORNE";
          var body = "";
          body += 'Bonjour, \n\nJe souhaite recevoir un devis pour la solution WELLBORNE ci dessous: \n\n';
          body += 'Modèle |	Nb bornes |	Nb point par charge |	Type courant	| Type charge |	Puissance cumulée |	Prix \n';
          for (var i = 0; i < trElements.length; i++) {
            var tdElements = trElements[i].getElementsByTagName("td");
            for (var j = 0; j < tdElements.length; j++) {
              var tdText = tdElements[j].textContent;
              body += tdText.trim(); // Ajoute le texte du td sans espaces supplémentaires
          
              if (j < tdElements.length - 1) {
                body += " | "; // Ajoute le symbole "|" entre chaque td, sauf le dernier
              }
            }
            body += "\n";
          }
          body += 'Total borne souhaité : ' + document.getElementById("prixtotal").innerText + ' \n';
          body += 'Total Général : ' + document.getElementById("totalglobal").innerText + ' \n';
          body += '\n Informations complémentaires: \n\n';
          body += 'Nombre de clients mensuel: ' + document.getElementById("nbclients").value + '\n';
          body += 'Temps Moyen client: ' + document.getElementById("tempsclient").value + 'min \n';
          body += "Ajout d'un tarif jaune: " + document.getElementById("ajouttarif").value + " \n";
          body +=  document.getElementById("texttarif").innerText + ' : ' + document.getElementById("tarifValue").innerText + ' \n';
          body += 'Prix du kWh : ' + document.getElementById("PrixKwh").value + '€ \n';
          body += 'temps de retour sur investissement : ' + document.getElementById("tempsretour").innerText + 'mois \n\n';
          body += 'Cordialement, \n\n';

          var mailtoLink = "mailto:" + recipient + "?subject=" + encodeURIComponent(subject) + "&body=" + encodeURIComponent(body);
        
          window.open(mailtoLink);
        });

  </script>
</body>

</html>
